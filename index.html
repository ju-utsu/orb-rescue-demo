<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VR Orb Collector</title>
  <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
  <script src="https://aframe.io/releases/1.4.1/aframe-ar.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background: black;
      color: white;
    }

    /* Main Menu Overlay */
    #mainMenu {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10;
      color: #fff;
    }

    #mainMenu h1 {
      font-size: 3em;
      margin-bottom: 20px;
    }

    .menu-option {
      margin: 10px;
    }

    .menu-option label {
      font-size: 1.2em;
    }

    select, button {
      padding: 10px;
      font-size: 1em;
      margin-left: 10px;
    }

    #startBtn {
      margin-top: 30px;
      background: #00ffcc;
      color: #000;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    #startBtn:hover {
      background: #00ddaa;
    }

    /* AR/VR buttons from A-Frame */
    .a-enter-vr-button, .a-enter-ar-button {
      z-index: 5 !important;
    }
  </style>
</head>
<body>
  <!-- Main Menu -->
  <div id="mainMenu">
    <h1>VR Orb Collector</h1>
    <div class="menu-option">
      <label for="gazeTime">Gaze Timer:</label>
      <select id="gazeTime">
        <option value="1000">1 sec</option>
        <option value="2000">2 sec</option>
        <option value="3000">3 sec</option>
      </select>
    </div>
    <div class="menu-option">
      <label for="difficulty">Difficulty:</label>
      <select id="difficulty">
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
      </select>
    </div>
    <button id="startBtn">Start Game</button>
  </div>

  <!-- A-Frame Scene -->
  <a-scene id="vrScene" embedded arjs vr-mode-ui="enabled: true" renderer="antialias: true" style="display:none;">
    <!-- Glowing Grid Environment -->
    <a-entity geometry="primitive: plane; height: 100; width: 100"
              rotation="-90 0 0"
              material="shader: standard; color: #111; emissive: #0ff; emissiveIntensity: 0.4; wireframe: true; wireframeLinewidth: 2">
    </a-entity>

    <!-- Camera + Cursor -->
    <a-entity camera look-controls>
      <a-cursor fuse="true" fuse-timeout="2000" material="color: #0ff; shader: flat;"></a-cursor>
    </a-entity>

    <!-- Lights -->
    <a-entity light="type: ambient; color: #fff; intensity: 0.6"></a-entity>
    <a-entity light="type: point; intensity: 1.2; distance: 50; decay: 2" position="0 5 0"></a-entity>
  </a-scene>

  <script>
    const startBtn = document.getElementById('startBtn');
    const mainMenu = document.getElementById('mainMenu');
    const vrScene = document.getElementById('vrScene');
    const gazeCursor = document.querySelector('a-cursor');

    startBtn.addEventListener('click', () => {
      const gazeTime = document.getElementById('gazeTime').value;
      const difficulty = document.getElementById('difficulty').value;

      // Apply gaze time to cursor
      gazeCursor.setAttribute('fuse-timeout', gazeTime);

      // Difficulty logic: number of orbs & hazards
      let orbCount, hazardCount;
      if (difficulty === 'easy') {
        orbCount = 10; hazardCount = 3;
      } else if (difficulty === 'medium') {
        orbCount = 20; hazardCount = 6;
      } else {
        orbCount = 30; hazardCount = 10;
      }

      // Hide menu, show VR scene
      mainMenu.style.display = 'none';
      vrScene.style.display = 'block';

      spawnObjects(orbCount, hazardCount);
    });

    function spawnObjects(orbCount, hazardCount) {
      const scene = document.querySelector('a-scene');

      for (let i = 0; i < orbCount; i++) {
        const orb = document.createElement('a-sphere');
        orb.setAttribute('radius', '0.4');
        orb.setAttribute('color', '#00ffff');
        orb.setAttribute('emissive', '#00ffff');
        orb.setAttribute('emissiveIntensity', '0.8');
        orb.setAttribute('position', randomPosition());
        scene.appendChild(orb);
      }

      for (let i = 0; i < hazardCount; i++) {
        const hazard = document.createElement('a-box');
        hazard.setAttribute('depth', '0.6');
        hazard.setAttribute('height', '0.6');
        hazard.setAttribute('width', '0.6');
        hazard.setAttribute('color', '#ff0044');
        hazard.setAttribute('emissive', '#ff0044');
        hazard.setAttribute('emissiveIntensity', '0.8');
        hazard.setAttribute('position', randomPosition());
        scene.appendChild(hazard);
      }
    }

    function randomPosition() {
      const x = (Math.random() * 20 - 10).toFixed(2);
      const y = (Math.random() * 3 + 1).toFixed(2);
      const z = (Math.random() * -15 - 5).toFixed(2);
      return `${x} ${y} ${z}`;
    }
  </script>
</body>
</html>

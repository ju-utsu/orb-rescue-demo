<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Orb Collector VR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
      }

      #hud {
        position: absolute;
        top: 15px;
        left: 15px;
        color: white;
        font-size: 20px;
        z-index: 10;
      }

      #menuButton {
        position: absolute;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: #333;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        cursor: pointer;
        z-index: 20;
      }

      #menu {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        color: white;
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 30;
      }

      #menu button {
        margin: 10px;
        padding: 12px 24px;
        font-size: 18px;
        background: #444;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
      }

      #menu button:hover {
        background: #666;
      }
    </style>
  </head>
  <body>
    <!-- HUD -->
    <div id="hud">Score: 0 | Time: 0s</div>

    <!-- Floating Menu Button -->
    <div id="menuButton">â˜°</div>

    <!-- Pause Menu -->
    <div id="menu">
      <h1>Game Paused</h1>
      <button id="resumeBtn">Resume</button>
      <button id="restartBtn">Restart</button>
    </div>

    <!-- A-Frame Scene -->
    <a-scene>
      <!-- Camera with cursor -->
      <a-entity
        id="camera"
        camera
        position="0 1.6 0"
        look-controls
        wasd-controls
      >
        <a-entity
          cursor="fuse: true; fuseTimeout: 1500"
          position="0 0 -1"
          geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
          material="color: white; shader: flat"
        ></a-entity>
      </a-entity>

      <!-- VR Button -->
      <a-entity id="vrButton" position="0 2 -2" text="value: Enter VR; color: white; align: center"></a-entity>

      <!-- Aesthetic Grid Environment -->
      <a-plane
        rotation="-90 0 0"
        width="30"
        height="30"
        color="#222"
        material="shader: standard; wireframe: true"
      ></a-plane>

      <!-- Lighting -->
      <a-entity light="type: ambient; color: #fff; intensity: 0.5"></a-entity>
      <a-entity light="type: point; intensity: 1" position="0 5 0"></a-entity>
    </a-scene>

    <script>
      const hud = document.getElementById("hud");
      const menu = document.getElementById("menu");
      const menuButton = document.getElementById("menuButton");
      const resumeBtn = document.getElementById("resumeBtn");
      const restartBtn = document.getElementById("restartBtn");
      const scene = document.querySelector("a-scene");

      let score = 0;
      let time = 0;
      let gamePaused = false;
      let gameOver = false;

      // Update HUD
      function updateHUD() {
        hud.innerText = `Score: ${score} | Time: ${time}s`;
      }

      // Timer
      setInterval(() => {
        if (!gamePaused && !gameOver) {
          time++;
          updateHUD();
        }
      }, 1000);

      // Pause menu toggle
      menuButton.addEventListener("click", () => {
        gamePaused = true;
        menu.style.display = "flex";
      });

      resumeBtn.addEventListener("click", () => {
        gamePaused = false;
        menu.style.display = "none";
      });

      restartBtn.addEventListener("click", () => {
        window.location.reload();
      });

      // Spawn Orbs and Dangers
      function spawnObjects() {
        if (gamePaused || gameOver) return;

        // Random position around player
        const x = (Math.random() - 0.5) * 10;
        const z = (Math.random() - 0.5) * 10;
        const y = 1.5;

        // Decide if orb or danger
        const isOrb = Math.random() > 0.3;
        const el = document.createElement("a-sphere");
        el.setAttribute("position", `${x} ${y} ${z}`);
        el.setAttribute("radius", "0.3");

        if (isOrb) {
          el.setAttribute("color", "#00f");
          el.classList.add("orb");
        } else {
          el.setAttribute("color", "#f00");
          el.classList.add("danger");
        }

        scene.appendChild(el);

        // Add gaze interaction
        el.addEventListener("mouseenter", () => {
          if (isOrb) {
            score++;
            updateHUD();
          } else {
            gameOver = true;
            alert("Game Over! Final Score: " + score);
          }
          el.parentNode.removeChild(el);
        });

        // Remove after 10s
        setTimeout(() => {
          if (el.parentNode) el.parentNode.removeChild(el);
        }, 10000);
      }

      setInterval(spawnObjects, 1500);

      updateHUD();
    </script>
  </body>
</html>

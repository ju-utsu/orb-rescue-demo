<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>VR Orb Collector</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  </head>
  <body style="margin:0;overflow:hidden;">
    <button id="startButton" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
      padding:20px;font-size:20px;z-index:999;">Start Game</button>

    <a-scene embedded vr-mode-ui="enabled: true" background="color: #000">
      <!-- Assets -->
      <a-assets>
        <audio id="bg-music" src="https://cdn.pixabay.com/download/audio/2021/09/15/audio_b62c11b6ff.mp3?filename=lofi-study-112191.mp3" preload="auto"></audio>
        <audio id="collect-sound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_55f55e5166.mp3?filename=collectcoin-6075.mp3" preload="auto"></audio>
      </a-assets>

      <!-- Camera + Cursor -->
      <a-entity id="player" position="0 1.6 0">
        <a-camera>
          <a-cursor color="yellow"></a-cursor>
        </a-camera>
      </a-entity>

      <!-- Lighting and Environment -->
      <a-entity light="type:ambient;intensity:0.8;color:#fff"></a-entity>
      <a-sky color="#101020"></a-sky>
      <a-plane rotation="-90 0 0" width="50" height="50" color="#222"></a-plane>

      <!-- Container for orbs -->
      <a-entity id="orb-container"></a-entity>
    </a-scene>

    <script>
      const startBtn = document.getElementById("startButton");
      const orbContainer = document.getElementById("orb-container");
      const bgMusic = document.getElementById("bg-music");
      const collectSound = document.getElementById("collect-sound");
      let score = 0;

      startBtn.addEventListener("click", () => {
        startBtn.style.display = "none";

        // Start background music
        bgMusic.play().catch(e => console.log("Audio play error:", e));
        bgMusic.loop = true;

        spawnOrbs(10);
      });

      function spawnOrbs(count) {
        for (let i = 0; i < count; i++) {
          const orb = document.createElement("a-sphere");
          orb.setAttribute("radius", "0.3");
          orb.setAttribute("color", "#ff00ff");
          orb.setAttribute("emissive", "#ff00ff");
          orb.setAttribute("position", randomPosition());
          orb.setAttribute("class", "collectible");

          // Gaze-based collection
          orb.addEventListener("mouseenter", () => {
            collectSound.play();
            orb.parentNode.removeChild(orb);
            score++;
            console.log("Score:", score);
          });

          orbContainer.appendChild(orb);
        }
      }

      function randomPosition() {
        const radius = 4 + Math.random() * 3; // 4–7 meters away
        const angle = Math.random() * Math.PI * 2;
        const x = radius * Math.cos(angle);
        const z = radius * Math.sin(angle);
        const y = 1 + Math.random() * 2; // height between 1–3
        return `${x} ${y} ${z}`;
      }
    </script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Neon Grid VR Game</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background: black;
      }
      #hud {
        position: absolute;
        top: 20px;
        left: 20px;
        font-size: 24px;
        color: cyan;
        font-family: Arial, sans-serif;
        text-shadow: 0 0 8px cyan;
        z-index: 999;
      }
    </style>
  </head>
  <body>
    <div id="hud">Score: 0</div>

    <a-scene background="color: #000" vr-mode-ui="enabled: true">
      <!-- Camera with Gaze Cursor -->
      <a-entity id="cameraRig" position="0 1.6 0">
        <a-camera>
          <a-cursor
            id="gazeCursor"
            fuse="true"
            fuse-timeout="150"
            material="color: cyan; shader: flat"
            geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.015"
          ></a-cursor>
        </a-camera>
      </a-entity>

      <!-- Neon Grid Floor -->
      <a-plane
        position="0 0 -5"
        rotation="-90 0 0"
        width="100"
        height="100"
        material="color: #111; shader: flat; side: double"
      ></a-plane>

      <!-- Tron-Style Grid Lines -->
      <a-entity neon-grid></a-entity>

      <!-- Orbs & Dangers will spawn here -->
      <a-entity id="gameObjects"></a-entity>

      <!-- Sky for aesthetic -->
      <a-sky color="#000"></a-sky>
    </a-scene>

    <script>
      let score = 0;
      const hud = document.getElementById("hud");
      const gameObjectsContainer = document.getElementById("gameObjects");

      // Component for neon grid
      AFRAME.registerComponent("neon-grid", {
        init: function () {
          const grid = document.createElement("a-entity");
          for (let x = -50; x <= 50; x += 5) {
            for (let z = -50; z <= 50; z += 5) {
              const line = document.createElement("a-plane");
              line.setAttribute("width", "0.1");
              line.setAttribute("height", "5");
              line.setAttribute("color", "#0ff");
              line.setAttribute("opacity", "0.4");
              line.setAttribute("rotation", "-90 0 0");
              line.setAttribute("position", `${x} 0.01 ${z}`);
              grid.appendChild(line);
            }
          }
          this.el.appendChild(grid);
        },
      });

      // Spawn Orbs and Danger Objects
      function spawnObjects() {
        for (let i = 0; i < 20; i++) {
          const orb = document.createElement("a-sphere");
          orb.setAttribute("color", "#0ff");
          orb.setAttribute("radius", "0.25");
          orb.setAttribute("position", randomPosition());
          orb.setAttribute("gaze-collect", "");
          orb.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 3000");
          gameObjectsContainer.appendChild(orb);
        }

        for (let i = 0; i < 10; i++) {
          const danger = document.createElement("a-box");
          danger.setAttribute("color", "red");
          danger.setAttribute("depth", "0.5");
          danger.setAttribute("height", "0.5");
          danger.setAttribute("width", "0.5");
          danger.setAttribute("position", randomPosition());
          danger.setAttribute("gaze-danger", "");
          danger.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 4000");
          gameObjectsContainer.appendChild(danger);
        }
      }

      function randomPosition() {
        const x = (Math.random() - 0.5) * 20;
        const y = Math.random() * 3 + 0.5;
        const z = (Math.random() - 0.5) * -20 - 3;
        return `${x} ${y} ${z}`;
      }

      AFRAME.registerComponent("gaze-collect", {
        init: function () {
          this.el.addEventListener("click", () => {
            this.el.parentNode.removeChild(this.el);
            score += 10;
            hud.textContent = "Score: " + score;
          });
        },
      });

      AFRAME.registerComponent("gaze-danger", {
        init: function () {
          this.el.addEventListener("click", () => {
            alert("Game Over! Final Score: " + score);
            location.reload();
          });
        },
      });

      spawnObjects();
    </script>
  </body>
</html>

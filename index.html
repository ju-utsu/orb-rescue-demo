<!DOCTYPE html>
<html>
  <head>
    <title>VR Orb Collector</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #0d0d0d;
        color: white;
        text-align: center;
      }

      #mainMenu {
        position: absolute;
        width: 100%;
        height: 100%;
        background: rgba(13, 13, 13, 0.95);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      #mainMenu h1 {
        font-size: 2.5em;
        margin-bottom: 20px;
        color: #00ffff;
      }

      #mainMenu label {
        display: block;
        margin-top: 15px;
      }

      #mainMenu input {
        margin-top: 5px;
        padding: 8px;
        border-radius: 6px;
        border: none;
        text-align: center;
      }

      #startBtn {
        margin-top: 25px;
        padding: 12px 20px;
        font-size: 18px;
        background: #00ffff;
        color: black;
        border: none;
        border-radius: 8px;
        cursor: pointer;
      }

      #startBtn:hover {
        background: #00cccc;
      }

      #hud {
        position: absolute;
        top: 20px;
        left: 20px;
        font-size: 18px;
        color: white;
        background: rgba(0, 0, 0, 0.4);
        padding: 8px 15px;
        border-radius: 10px;
        display: none;
      }

      a-scene {
        display: none;
      }
    </style>
  </head>
  <body>
    <!-- Main Menu -->
    <div id="mainMenu">
      <h1>VR Orb Collector</h1>
      <label>
        Gaze Timer (ms):
        <input type="number" id="gazeTime" value="1500" min="500" />
      </label>
      <label>
        Number of Orbs:
        <input type="number" id="numOrbs" value="15" min="5" />
      </label>
      <label>
        Number of Dangers:
        <input type="number" id="numDangers" value="8" min="1" />
      </label>
      <button id="startBtn">Start Game</button>
    </div>

    <!-- HUD -->
    <div id="hud">Score: 0</div>

    <!-- VR Scene -->
    <a-scene>
      <a-assets>
        <audio id="collect-sound" src="https://cdn.freesound.org/previews/341/341695_5858296-lq.mp3"></audio>
      </a-assets>

      <!-- Camera -->
      <a-entity id="camera" camera look-controls>
        <a-entity cursor="fuse: true; fuseTimeout: 1500" position="0 0 -1"
          geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
          material="color: cyan; shader: flat">
        </a-entity>
      </a-entity>

      <!-- Ground Grid -->
      <a-entity geometry="primitive: plane; width: 100; height: 100"
                material="color: #0d0d0d; shader: flat; wireframe: true; opacity: 0.2"
                rotation="-90 0 0">
      </a-entity>

      <!-- Lighting -->
      <a-entity light="type: ambient; intensity: 0.6"></a-entity>
      <a-entity light="type: directional; intensity: 0.8" position="2 4 -2"></a-entity>
    </a-scene>

    <script>
      const startBtn = document.getElementById("startBtn");
      const mainMenu = document.getElementById("mainMenu");
      const hud = document.getElementById("hud");
      const scene = document.querySelector("a-scene");
      const collectSound = document.querySelector("#collect-sound");
      const cursor = document.querySelector("[cursor]");

      let score = 0;
      let gazeTimeValue = 1500;

      startBtn.addEventListener("click", () => {
        gazeTimeValue = parseInt(document.getElementById("gazeTime").value);
        const numOrbs = parseInt(document.getElementById("numOrbs").value);
        const numDangers = parseInt(document.getElementById("numDangers").value);

        cursor.setAttribute("cursor", `fuse: true; fuseTimeout: ${gazeTimeValue}`);

        mainMenu.style.display = "none";
        scene.style.display = "block";
        hud.style.display = "block";

        spawnObjects(numOrbs, numDangers);
      });

      function spawnObjects(orbsCount, dangersCount) {
        for (let i = 0; i < orbsCount; i++) {
          const orb = document.createElement("a-sphere");
          orb.setAttribute("radius", "0.3");
          orb.setAttribute("color", "#00ffff");
          orb.setAttribute("position", randomPosition());
          orb.setAttribute("class", "collectible");
          scene.appendChild(orb);
        }

        for (let i = 0; i < dangersCount; i++) {
          const danger = document.createElement("a-box");
          danger.setAttribute("depth", "0.5");
          danger.setAttribute("height", "0.5");
          danger.setAttribute("width", "0.5");
          danger.setAttribute("color", "red");
          danger.setAttribute("position", randomPosition());
          danger.setAttribute("class", "danger");
          scene.appendChild(danger);
        }

        addInteractions();
      }

      function randomPosition() {
        const x = (Math.random() - 0.5) * 10;
        const y = Math.random() * 2 + 0.5;
        const z = (Math.random() - 0.5) * -10;
        return `${x} ${y} ${z}`;
      }

      function addInteractions() {
        document.querySelectorAll(".collectible").forEach((orb) => {
          orb.addEventListener("click", () => {
            orb.parentNode.removeChild(orb);
            score += 10;
            hud.innerText = `Score: ${score}`;
            collectSound.play();
          });
        });

        document.querySelectorAll(".danger").forEach((danger) => {
          danger.addEventListener("click", () => {
            danger.parentNode.removeChild(danger);
            score -= 5;
            hud.innerText = `Score: ${score}`;
          });
        });
      }
    </script>
  </body>
</html>
